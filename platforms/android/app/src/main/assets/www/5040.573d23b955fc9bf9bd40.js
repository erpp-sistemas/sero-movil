(self.webpackChunkerpp_movil=self.webpackChunkerpp_movil||[]).push([[5040],{75040:(t,e,i)=>{"use strict";i.r(e),i.d(e,{GoogleMapsPageModule:()=>b});var o=i(61116),n=i(11462),a=i(54812),s=i(9069),r=i(64762),l=i(98799),c=i(87368),u=i(18372),h=i(79899),g=i(75919),m=i(9935),p=i(90074);let d=(()=>{class t{constructor(t,e,i,o){this.router=t,this.storage=e,this.ngZone=i,this.iab=o}gestion(t){this.storage.set("account",t),this.ngZone.run(()=>{this.router.navigateByUrl("/gestion-page")})}goPhotos(t){this.storage.set("accountNumber",t),this.ngZone.run(()=>{this.router.navigateByUrl("/photos-detail")})}street(t){return(0,r.mG)(this,void 0,void 0,function*(){let e=t;this.ngZone.run(()=>{this.router.navigate(["streetview"],{state:{position:e}})})})}goArcgis(t){return(0,r.mG)(this,void 0,void 0,function*(){const e=yield this.storage.get("rutaArcgis");this.iab.create(e+"&find="+t,"_system",{location:"yes",zoom:"yes"})})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(s.F0),c.Y36(u.Ke),c.Y36(c.R0b),c.Y36(h.i))},t.\u0275cmp=c.Xpm({type:t,selectors:[["custom-tag"]],decls:17,vars:3,consts:[[2,"width","190px","height","120px"],["ion-label",""],[2,"font-size","14px","word-wrap","break-word","white-space","normal"],["ion-button","","size","small","color","success","expand","block",2,"background-color","#049c37","padding","10px","color","white",3,"click"],["ion-button","","size","small","color","success","expand","block",2,"background-color","#2427e4","padding","10px","color","white","margin-left","10px",3,"click"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div"),c.TgZ(2,"label",1),c.TgZ(3,"p",2),c.TgZ(4,"strong"),c._uU(5,"Cuenta:"),c.qZA(),c._uU(6),c.TgZ(7,"strong"),c._uU(8,"Propietario:"),c.qZA(),c._uU(9),c.TgZ(10,"strong"),c._uU(11,"Deuda:$"),c.qZA(),c._uU(12),c.qZA(),c.qZA(),c.qZA(),c.TgZ(13,"button",3),c.NdJ("click",function(){return e.gestion(e.account)}),c._uU(14," Gestionar "),c.qZA(),c.TgZ(15,"button",4),c.NdJ("click",function(){return e.street(e.position)}),c._uU(16," StreetView "),c.qZA(),c.qZA()),2&t&&(c.xp6(6),c.hij("",e.account," "),c.xp6(3),c.hij("",e.owner," "),c.xp6(3),c.Oqu(e.debt))},encapsulation:2}),t})();const Z=[{path:"",component:(()=>{class t{constructor(t,e,i,o,n,a,s,r,c,u,h,g){this.ngZone=t,this.injector=e,this.resolver=i,this.appRef=o,this.storage=n,this.router=a,this.platform=s,this.service=r,this.loadingCtrl=c,this.mensaje=u,this.activeRoute=h,this.callNumber=g,this.htmlInfoWindow=new l.rb,this.accountString=""}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){yield this.platform.ready(),this.idServicioPlaza=this.activeRoute.snapshot.paramMap.get("id"),this.id_plaza=this.activeRoute.snapshot.paramMap.get("id_plaza"),yield this.getAccountInfo(this.id_plaza,this.idServicioPlaza)})}ionViewWillLeave(){}getAccountInfo(t,e){return(0,r.mG)(this,void 0,void 0,function*(){this.markersArrayInfo=yield this.service.getDataVisitPosition(t,e),this.markersArrayInfo.length<=0?(this.mensaje.showAlert("Tienes que descargar informaci\xf3n para visualizar las cuentas en el mapa!!!!"),this.router.navigateByUrl("/home")):(this.loading=yield this.loadingCtrl.create({message:"Cargando cuentas en el mapa..."}),yield this.loading.present(),yield this.setMarkers(this.markersArrayInfo))})}setMarkers(t){let e=[];for(let i of t){let t=new l.MP(parseFloat(i.latitud),parseFloat(i.longitud));e.push({position:t,cuenta:i.cuenta,propietario:i.propietario,deuda:i.total,icon:"../../assets/icon/gota.png"})}this.loadMap(e)}loadMap(t){return(0,r.mG)(this,void 0,void 0,function*(){this.map=l.hz.create("map_canvas",{mapType:l.OE.ROADMAP,controls:{compass:!0,myLocationButton:!0,mapTypeControl:!0,streetViewControl:!0,myLocation:!0,mapToolbar:!0},gestures:{scroll:!0,tilt:!0,zoom:!0,rotate:!0}}),this.map.getMyLocation().then(t=>(0,r.mG)(this,void 0,void 0,function*(){console.log(JSON.stringify(t,null,2))})).catch(t=>{}),this.addCluster(t),this.map.animateCamera({target:t[0].position,zoom:12,tilt:30}),this.loading.dismiss()})}addCluster(t){this.markerCluster=this.map.addMarkerClusterSync({markers:t,icons:[{min:5,max:20,url:"./assets/markercluster/small.png",label:{color:"white"}},{min:21,max:50,url:"./assets/markercluster/large.png",label:{color:"white"}},{min:51,url:"./assets/markercluster/large.png",label:{color:"white"}}]}),this.markerCluster.on(l.mZ.MARKER_CLICK).subscribe(t=>{let e=t.pop();this.compFactory=this.resolver.resolveComponentFactory(d),this.compRef=this.compFactory.create(this.injector),this.compRef.instance.account=e.get("cuenta"),this.compRef.instance.owner=e.get("propietario"),this.compRef.instance.debt=e.get("deuda"),this.compRef.instance.position=e.get("position"),this.appRef.attachView(this.compRef.hostView),this.div=document.createElement("div"),this.div.appendChild(this.compRef.location.nativeElement),this.ngZone.run(()=>{this.htmlInfoWindow.setContent(this.div),this.htmlInfoWindow.open(e)}),this.htmlInfoWindow.one(l.mZ.INFO_CLOSE).then(()=>{this.compRef.destroy()})})}goDetail(){this.router.navigateByUrl("/detail")}getDetail(t){return(0,r.mG)(this,void 0,void 0,function*(){yield this.storage.set("accountNumber",t),this.goDetail()})}find(){return(0,r.mG)(this,void 0,void 0,function*(){if(""==this.accountString)alert("Ingresa una cuenta");else if(this.result=yield this.service.getDataVisitPositionByAccount(this.accountString),0==this.result.length)alert("No hay resultados");else{let t=new l.MP(this.result[0].latitud,this.result[0].longitud);this.map.setCameraTarget(t),this.map.setCameraZoom(20)}})}navegar(t){1==t?this.ngZone.run(()=>{this.router.navigateByUrl("home/tab1")}):2==t?this.ngZone.run(()=>{this.router.navigateByUrl("home/tab2")}):3==t?this.ngZone.run(()=>{this.router.navigateByUrl("home/tab3")}):4==t?this.ngZone.run(()=>{this.router.navigateByUrl("home/tab4")}):5==t&&this.callNumber.callNumber("911",!0).then(t=>console.log("Launched dialer!",t)).catch(t=>console.log("Error launching dialer",t))}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(c.R0b),c.Y36(c.zs3),c.Y36(c._Vd),c.Y36(c.z2F),c.Y36(u.Ke),c.Y36(s.F0),c.Y36(a.t4),c.Y36(g.v),c.Y36(a.HT),c.Y36(m.K),c.Y36(s.gz),c.Y36(p.X))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-google-maps"]],decls:37,vars:1,consts:[["placeholder","Buscar por cuenta",3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","search"],["id","map_canvas",1,"map"],["scrollable",""],["color","light","name","home"],["color","light",2,"font-size","2px"],["color","light","name","layers"],["color","light","name","map"],["color","light","name","warning"],["src","../../../assets/img/sos.png","alt","",2,"width","30px","height","30px","margin-bottom","-15px"],["color","light",2,"font-size","3px","margin-bottom","-1px"]],template:function(t,e){1&t&&(c._UZ(0,"hr"),c._UZ(1,"hr"),c._UZ(2,"hr"),c._UZ(3,"hr"),c.TgZ(4,"ion-content"),c.TgZ(5,"ion-toolbar"),c.TgZ(6,"ion-input",0),c.NdJ("ngModelChange",function(t){return e.accountString=t}),c.qZA(),c.TgZ(7,"ion-buttons",1),c.TgZ(8,"ion-button",2),c.NdJ("click",function(){return e.find()}),c._UZ(9,"ion-icon",3),c.qZA(),c.qZA(),c.qZA(),c._UZ(10,"div",4),c.qZA(),c.TgZ(11,"ion-segment",5),c.TgZ(12,"ion-segment-button",2),c.NdJ("click",function(){return e.navegar(1)}),c._UZ(13,"ion-icon",6),c.TgZ(14,"ion-label",7),c.TgZ(15,"small"),c._uU(16,"Inicio"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(17,"ion-segment-button",2),c.NdJ("click",function(){return e.navegar(2)}),c._UZ(18,"ion-icon",8),c.TgZ(19,"ion-label",7),c.TgZ(20,"small"),c._uU(21,"Cuentas"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(22,"ion-segment-button",2),c.NdJ("click",function(){return e.navegar(3)}),c._UZ(23,"ion-icon",9),c.TgZ(24,"ion-label",7),c.TgZ(25,"small"),c._uU(26,"Mapa"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(27,"ion-segment-button",2),c.NdJ("click",function(){return e.navegar(4)}),c._UZ(28,"ion-icon",10),c.TgZ(29,"ion-label",7),c.TgZ(30,"small"),c._uU(31,"S.P\xfablicos"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(32,"ion-segment-button",2),c.NdJ("click",function(){return e.navegar(5)}),c._UZ(33,"img",11),c.TgZ(34,"ion-label",12),c.TgZ(35,"small"),c._uU(36,"S.O.S."),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(6),c.Q6J("ngModel",e.accountString))},directives:[a.W2,a.sr,a.pK,a.j9,n.JJ,n.On,a.Sm,a.YG,a.gu,a.cJ,a.QI,a.GO,a.Q$],styles:["#map_canvas[_ngcontent-%COMP%], #mapa_contenedor[_ngcontent-%COMP%]{width:100%!important;height:100%!important}ion-segment[_ngcontent-%COMP%]{--background:#254061;border-top:1px solid #0000001a;height:60px;margin-bottom:-5px}ion-segment-button[_ngcontent-%COMP%]{--indicator-color:#0000!important}"]}),t})()}];let f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[s.Bz.forChild(Z)],s.Bz]}),t})();var v=i(5530);let b=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[a.Pc,o.ez,n.u5,f,v.K]]}),t})()}}]);